# AMP Dockerfile for Java on ARM

FROM greelan/amp:java-arm

RUN mkdir -p /usr/share/man/man1 &&\
 apt-get update &&\
 apt-get install -y dirmngr apt-transport-https gpg-agent dnsutils gnupg2 libcurl4 &&\
 wget -qO - https://packages.adoptium.net/artifactory/api/gpg/key/public | gpg --dearmor | tee /etc/apt/keyrings/adoptium.gpg &&\
 echo "deb [arch=arm64 signed-by=/etc/apt/keyrings/adoptium.gpg] https://packages.adoptium.net/artifactory/deb bookworm main" | tee /etc/apt/sources.list.d/adoptium.list &&\
 apt-get update &&\
 apt-get install -y temurin-8-jdk temurin-11-jdk temurin-17-jdk temurin-21-jdk &&\
 apt-get clean &&\
 rm -rf /var/lib/apt/lists/* &&\
 sed -i 's#mozilla/DST_Root_CA_X3.crt#!mozilla/DST_Root_CA_X3.crt#' /etc/ca-certificates.conf && update-ca-certificates

ADD ampstart.sh /

ENTRYPOINT ["/ampstart.sh"]
CMD []
